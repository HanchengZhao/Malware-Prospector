import csv

with open('../../data/raw_csv/1_features.csv','rb') as f:
	first_line = f.readline().split(",")
	# array for each feature
	data = [[] * i for i in xrange(len(first_line)-1)]
	reader = csv.reader(f)
	# skip first line
	next(reader, None)
	for row in reader:
		for i in xrange(len(row[1:])):
			data[i].append(float(row[1:][i]))
f.close()
# print len(data)
# print len(first_line)
with open("../../data/data.csv", "wb") as f:
	csvwriter = csv.writer(f)
	csvwriter.writerow(["feature_name","min","max","step"])
	for j in xrange(len(data)):
		row = []
		row.append(first_line[j+1].strip("\n")) #name, remove "\n"
		Min = float(min(data[j]))
		Max = float(max(data[j]))
		row.append(Min)
		row.append(Max)
		row.append("{0:.3f}".format((Max-Min)/len(data[j]))) #step
		csvwriter.writerow(row)
f.close()
print "processing features done"
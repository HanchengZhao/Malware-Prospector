import csv
import numpy as np
import pickle
import json
# print importances
# feature_names = open('../data/a_features.csv','rb').readline().split(",")[1:]
# print feature_names
def ranking(indices, outDir):
	with open('../../data/data.csv') as datacsv:
		featureArray = []
		reader = csv.DictReader(datacsv)
		for row in reader:
			feature = {}
			feature[row['feature_name']] = {"min" : row['min'], "max" : row['max'], "step": row['step'] }
			featureArray.append(feature)
		
	ranking = []
	for i in indices:
		ranking.append(featureArray[i])
	# print ranking
	with open(outDir, 'wb') as output:
			pickle.dump(ranking, output, pickle.HIGHEST_PROTOCOL)

forest1 = pickle.load(open("../../data/models/random_forest_n_estimators_50.pkl", "rb" ) )
imp = "feature_importances_"
importances1 = forest1.feature_importances_
# importances1 = eval("forest1." + imp)
indices = np.argsort(importances1)[::-1]
ranking(indices, "../../data/ranking/forests_ranking_50.pkl")

print "Done with forests_ranking"

forest2 = pickle.load(open("../../data/models/randomized_lasso_max_iter_1000.pkl", "rb" ) )
importances2 = forest2.scores_
indices_l = np.argsort(importances2)[::-1]
ranking(indices_l, "../../data/ranking/lasso_ranking_1000.pkl")

print "Done with lasso_ranking"


